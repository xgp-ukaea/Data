
from numpy import array, log, meshgrid, linspace, savez

density_axis = array([
    5.00E+07, 1.00E+08, 2.00E+08, 5.00E+08, 1.00E+09, 2.00E+09, 5.00E+09, 1.00E+10,
    2.00E+10, 5.00E+10, 1.00E+11, 2.00E+11, 5.00E+11, 1.00E+12, 2.00E+12, 5.00E+12,
    1.00E+13, 2.00E+13, 5.00E+13, 1.00E+14, 2.00E+14, 5.00E+14, 1.00E+15, 2.00E+15
])

temperature_axis = array([
    2.00E-01, 3.00E-01, 5.00E-01, 7.00E-01, 1.00E+00, 1.50E+00, 2.00E+00, 3.00E+00,
    5.00E+00, 7.00E+00, 1.00E+01, 1.50E+01, 2.00E+01, 3.00E+01, 5.00E+01, 7.00E+01,
    1.00E+02, 1.50E+02, 2.00E+02, 3.00E+02, 5.00E+02, 7.00E+02, 1.00E+03, 1.50E+03,
    2.00E+03, 3.00E+03, 5.00E+03, 7.00E+03, 1.00E+04
])

recombination_pec = array([
    [1.45E-14, 9.45E-15, 5.55E-15, 3.90E-15, 2.67E-15, 1.71E-15, 1.24E-15, 7.83E-16, 4.31E-16, 2.89E-16, 1.87E-16, 1.13E-16, 7.91E-17, 4.73E-17, 2.45E-17, 1.58E-17, 9.84E-18, 5.73E-18, 3.88E-18, 2.24E-18, 1.11E-18, 6.92E-19, 4.19E-19, 2.36E-19, 1.57E-19, 8.76E-20, 4.19E-20, 2.57E-20, 1.52E-20],
    [1.52E-14, 9.81E-15, 5.69E-15, 3.98E-15, 2.71E-15, 1.73E-15, 1.25E-15, 7.89E-16, 4.33E-16, 2.90E-16, 1.88E-16, 1.14E-16, 7.91E-17, 4.73E-17, 2.45E-17, 1.57E-17, 9.83E-18, 5.72E-18, 3.88E-18, 2.23E-18, 1.10E-18, 6.91E-19, 4.18E-19, 2.36E-19, 1.56E-19, 8.74E-20, 4.18E-20, 2.56E-20, 1.52E-20],
    [1.62E-14, 1.03E-14, 5.88E-15, 4.09E-15, 2.76E-15, 1.76E-15, 1.27E-15, 7.95E-16, 4.36E-16, 2.91E-16, 1.88E-16, 1.14E-16, 7.92E-17, 4.72E-17, 2.44E-17, 1.57E-17, 9.81E-18, 5.70E-18, 3.87E-18, 2.23E-18, 1.10E-18, 6.89E-19, 4.17E-19, 2.35E-19, 1.56E-19, 8.72E-20, 4.17E-20, 2.56E-20, 1.52E-20],
    [1.79E-14, 1.11E-14, 6.23E-15, 4.28E-15, 2.87E-15, 1.81E-15, 1.30E-15, 8.08E-16, 4.40E-16, 2.93E-16, 1.89E-16, 1.14E-16, 7.92E-17, 4.72E-17, 2.44E-17, 1.57E-17, 9.77E-18, 5.68E-18, 3.85E-18, 2.22E-18, 1.10E-18, 6.86E-19, 4.16E-19, 2.34E-19, 1.55E-19, 8.69E-20, 4.15E-20, 2.55E-20, 1.51E-20],
    [1.98E-14, 1.21E-14, 6.60E-15, 4.48E-15, 2.97E-15, 1.86E-15, 1.33E-15, 8.22E-16, 4.45E-16, 2.95E-16, 1.90E-16, 1.14E-16, 7.92E-17, 4.71E-17, 2.43E-17, 1.56E-17, 9.73E-18, 5.65E-18, 3.83E-18, 2.21E-18, 1.09E-18, 6.83E-19, 4.14E-19, 2.33E-19, 1.55E-19, 8.65E-20, 4.14E-20, 2.54E-20, 1.51E-20],
    [2.26E-14, 1.34E-14, 7.13E-15, 4.78E-15, 3.13E-15, 1.94E-15, 1.37E-15, 8.43E-16, 4.52E-16, 2.98E-16, 1.91E-16, 1.14E-16, 7.93E-17, 4.70E-17, 2.42E-17, 1.55E-17, 9.67E-18, 5.62E-18, 3.81E-18, 2.19E-18, 1.08E-18, 6.78E-19, 4.11E-19, 2.32E-19, 1.54E-19, 8.60E-20, 4.12E-20, 2.52E-20, 1.50E-20],
    [2.85E-14, 1.62E-14, 8.25E-15, 5.40E-15, 3.47E-15, 2.10E-15, 1.47E-15, 8.88E-16, 4.67E-16, 3.05E-16, 1.94E-16, 1.15E-16, 7.94E-17, 4.68E-17, 2.40E-17, 1.54E-17, 9.55E-18, 5.54E-18, 3.76E-18, 2.16E-18, 1.07E-18, 6.69E-19, 4.06E-19, 2.29E-19, 1.52E-19, 8.51E-20, 4.08E-20, 2.50E-20, 1.49E-20],
    [3.62E-14, 1.98E-14, 9.70E-15, 6.21E-15, 3.90E-15, 2.31E-15, 1.59E-15, 9.45E-16, 4.87E-16, 3.15E-16, 1.97E-16, 1.16E-16, 7.95E-17, 4.66E-17, 2.37E-17, 1.51E-17, 9.39E-18, 5.44E-18, 3.69E-18, 2.12E-18, 1.05E-18, 6.58E-19, 4.00E-19, 2.26E-19, 1.50E-19, 8.40E-20, 4.03E-20, 2.47E-20, 1.47E-20],
    [4.92E-14, 2.56E-14, 1.20E-14, 7.45E-15, 4.55E-15, 2.62E-15, 1.77E-15, 1.03E-15, 5.15E-16, 3.28E-16, 2.03E-16, 1.17E-16, 7.97E-17, 4.62E-17, 2.32E-17, 1.48E-17, 9.14E-18, 5.29E-18, 3.58E-18, 2.06E-18, 1.02E-18, 6.40E-19, 3.89E-19, 2.20E-19, 1.47E-19, 8.23E-20, 3.96E-20, 2.43E-20, 1.45E-20],
    [7.93E-14, 3.83E-14, 1.65E-14, 9.77E-15, 5.71E-15, 3.14E-15, 2.07E-15, 1.16E-15, 5.59E-16, 3.48E-16, 2.11E-16, 1.19E-16, 8.00E-17, 4.56E-17, 2.25E-17, 1.42E-17, 8.70E-18, 4.99E-18, 3.37E-18, 1.93E-18, 9.57E-19, 6.02E-19, 3.67E-19, 2.08E-19, 1.39E-19, 7.84E-20, 3.79E-20, 2.34E-20, 1.40E-20],
    [1.14E-13, 5.13E-14, 2.06E-14, 1.18E-14, 6.65E-15, 3.55E-15, 2.29E-15, 1.25E-15, 5.91E-16, 3.62E-16, 2.16E-16, 1.21E-16, 8.02E-17, 4.51E-17, 2.20E-17, 1.37E-17, 8.33E-18, 4.74E-18, 3.18E-18, 1.82E-18, 8.97E-19, 5.63E-19, 3.43E-19, 1.95E-19, 1.30E-19, 7.38E-20, 3.58E-20, 2.22E-20, 1.33E-20],
    [1.54E-13, 6.49E-14, 2.45E-14, 1.36E-14, 7.47E-15, 3.89E-15, 2.48E-15, 1.33E-15, 6.17E-16, 3.74E-16, 2.21E-16, 1.22E-16, 8.04E-17, 4.47E-17, 2.15E-17, 1.33E-17, 8.00E-18, 4.51E-18, 3.01E-18, 1.70E-18, 8.34E-19, 5.21E-19, 3.17E-19, 1.80E-19, 1.20E-19, 6.81E-20, 3.32E-20, 2.06E-20, 1.24E-20],
    [2.04E-13, 8.05E-14, 2.86E-14, 1.54E-14, 8.27E-15, 4.22E-15, 2.66E-15, 1.41E-15, 6.41E-16, 3.85E-16, 2.26E-16, 1.23E-16, 8.06E-17, 4.43E-17, 2.10E-17, 1.29E-17, 7.66E-18, 4.27E-18, 2.82E-18, 1.58E-18, 7.63E-19, 4.73E-19, 2.85E-19, 1.61E-19, 1.07E-19, 6.04E-20, 2.94E-20, 1.82E-20, 1.10E-20],
    [2.34E-13, 8.91E-14, 3.08E-14, 1.63E-14, 8.67E-15, 4.38E-15, 2.74E-15, 1.44E-15, 6.53E-16, 3.91E-16, 2.28E-16, 1.24E-16, 8.07E-17, 4.41E-17, 2.07E-17, 1.26E-17, 7.48E-18, 4.14E-18, 2.72E-18, 1.51E-18, 7.22E-19, 4.45E-19, 2.67E-19, 1.49E-19, 9.89E-20, 5.55E-20, 2.68E-20, 1.66E-20, 9.99E-21],
    [2.56E-13, 9.51E-14, 3.22E-14, 1.69E-14, 8.93E-15, 4.48E-15, 2.80E-15, 1.47E-15, 6.61E-16, 3.95E-16, 2.29E-16, 1.24E-16, 8.07E-17, 4.40E-17, 2.06E-17, 1.25E-17, 7.36E-18, 4.05E-18, 2.65E-18, 1.46E-18, 6.93E-19, 4.24E-19, 2.53E-19, 1.40E-19, 9.26E-20, 5.16E-20, 2.47E-20, 1.52E-20, 9.13E-21],
    [2.74E-13, 1.00E-13, 3.34E-14, 1.74E-14, 9.14E-15, 4.57E-15, 2.84E-15, 1.48E-15, 6.67E-16, 3.97E-16, 2.31E-16, 1.25E-16, 8.08E-17, 4.39E-17, 2.04E-17, 1.24E-17, 7.26E-18, 3.97E-18, 2.59E-18, 1.42E-18, 6.68E-19, 4.07E-19, 2.41E-19, 1.33E-19, 8.69E-20, 4.80E-20, 2.28E-20, 1.39E-20, 8.30E-21],
    [2.82E-13, 1.02E-13, 3.39E-14, 1.76E-14, 9.24E-15, 4.61E-15, 2.86E-15, 1.49E-15, 6.70E-16, 3.99E-16, 2.31E-16, 1.25E-16, 8.08E-17, 4.39E-17, 2.04E-17, 1.23E-17, 7.22E-18, 3.94E-18, 2.57E-18, 1.40E-18, 6.57E-19, 3.99E-19, 2.35E-19, 1.29E-19, 8.43E-20, 4.63E-20, 2.18E-20, 1.33E-20, 7.89E-21],
    [2.87E-13, 1.04E-13, 3.43E-14, 1.78E-14, 9.30E-15, 4.63E-15, 2.88E-15, 1.50E-15, 6.72E-16, 3.99E-16, 2.31E-16, 1.25E-16, 8.08E-17, 4.38E-17, 2.03E-17, 1.23E-17, 7.19E-18, 3.92E-18, 2.55E-18, 1.39E-18, 6.50E-19, 3.93E-19, 2.31E-19, 1.27E-19, 8.26E-20, 4.52E-20, 2.12E-20, 1.29E-20, 7.61E-21],
    [2.91E-13, 1.05E-13, 3.46E-14, 1.79E-14, 9.35E-15, 4.65E-15, 2.88E-15, 1.50E-15, 6.73E-16, 4.00E-16, 2.32E-16, 1.25E-16, 8.08E-17, 4.38E-17, 2.03E-17, 1.22E-17, 7.17E-18, 3.90E-18, 2.54E-18, 1.38E-18, 6.44E-19, 3.89E-19, 2.29E-19, 1.25E-19, 8.12E-20, 4.44E-20, 2.07E-20, 1.26E-20, 7.39E-21],
    [2.93E-13, 1.06E-13, 3.47E-14, 1.80E-14, 9.37E-15, 4.66E-15, 2.89E-15, 1.50E-15, 6.73E-16, 4.00E-16, 2.32E-16, 1.25E-16, 8.08E-17, 4.38E-17, 2.03E-17, 1.22E-17, 7.16E-18, 3.90E-18, 2.53E-18, 1.38E-18, 6.42E-19, 3.88E-19, 2.27E-19, 1.24E-19, 8.06E-20, 4.40E-20, 2.05E-20, 1.24E-20, 7.29E-21],
    [2.94E-13, 1.06E-13, 3.48E-14, 1.80E-14, 9.38E-15, 4.66E-15, 2.89E-15, 1.50E-15, 6.74E-16, 4.00E-16, 2.32E-16, 1.25E-16, 8.08E-17, 4.38E-17, 2.03E-17, 1.22E-17, 7.16E-18, 3.89E-18, 2.53E-18, 1.38E-18, 6.40E-19, 3.87E-19, 2.27E-19, 1.23E-19, 8.03E-20, 4.38E-20, 2.04E-20, 1.23E-20, 7.23E-21],
    [2.95E-13, 1.07E-13, 3.49E-14, 1.80E-14, 9.39E-15, 4.66E-15, 2.89E-15, 1.50E-15, 6.74E-16, 4.00E-16, 2.32E-16, 1.25E-16, 8.08E-17, 4.38E-17, 2.03E-17, 1.22E-17, 7.15E-18, 3.89E-18, 2.53E-18, 1.38E-18, 6.39E-19, 3.86E-19, 2.26E-19, 1.23E-19, 8.00E-20, 4.36E-20, 2.03E-20, 1.22E-20, 7.18E-21],
    [2.96E-13, 1.07E-13, 3.49E-14, 1.81E-14, 9.40E-15, 4.67E-15, 2.89E-15, 1.50E-15, 6.74E-16, 4.00E-16, 2.32E-16, 1.25E-16, 8.08E-17, 4.38E-17, 2.03E-17, 1.22E-17, 7.15E-18, 3.89E-18, 2.53E-18, 1.37E-18, 6.39E-19, 3.86E-19, 2.26E-19, 1.23E-19, 7.99E-20, 4.35E-20, 2.02E-20, 1.22E-20, 7.16E-21],
    [2.96E-13, 1.07E-13, 3.50E-14, 1.81E-14, 9.40E-15, 4.67E-15, 2.89E-15, 1.50E-15, 6.74E-16, 4.00E-16, 2.32E-16, 1.25E-16, 8.08E-17, 4.38E-17, 2.03E-17, 1.22E-17, 7.15E-18, 3.89E-18, 2.52E-18, 1.37E-18, 6.38E-19, 3.85E-19, 2.26E-19, 1.23E-19, 7.98E-20, 4.35E-20, 2.02E-20, 1.22E-20, 7.15E-21]
])

excitation_pec = array([
    [4.76E-39, 1.82E-29, 7.81E-22, 1.40E-18, 3.71E-16, 2.75E-14, 2.32E-13, 1.92E-12, 1.03E-11, 2.11E-11, 3.61E-11, 5.48E-11, 6.74E-11, 8.24E-11, 9.52E-11, 9.97E-11, 1.01E-10, 9.92E-11, 9.60E-11, 8.95E-11, 7.96E-11, 7.27E-11, 6.54E-11, 5.75E-11, 5.23E-11, 4.55E-11, 3.79E-11, 3.35E-11, 2.93E-11],
    [4.74E-39, 1.81E-29, 7.76E-22, 1.39E-18, 3.68E-16, 2.72E-14, 2.30E-13, 1.91E-12, 1.02E-11, 2.09E-11, 3.58E-11, 5.43E-11, 6.68E-11, 8.18E-11, 9.45E-11, 9.90E-11, 1.01E-10, 9.86E-11, 9.54E-11, 8.90E-11, 7.92E-11, 7.23E-11, 6.51E-11, 5.73E-11, 5.21E-11, 4.53E-11, 3.77E-11, 3.34E-11, 2.92E-11],
    [4.72E-39, 1.80E-29, 7.70E-22, 1.37E-18, 3.64E-16, 2.69E-14, 2.27E-13, 1.89E-12, 1.01E-11, 2.07E-11, 3.54E-11, 5.37E-11, 6.61E-11, 8.10E-11, 9.37E-11, 9.82E-11, 9.97E-11, 9.78E-11, 9.47E-11, 8.84E-11, 7.86E-11, 7.19E-11, 6.47E-11, 5.69E-11, 5.18E-11, 4.51E-11, 3.76E-11, 3.32E-11, 2.91E-11],
    [4.69E-39, 1.78E-29, 7.60E-22, 1.35E-18, 3.58E-16, 2.64E-14, 2.23E-13, 1.85E-12, 9.89E-12, 2.02E-11, 3.47E-11, 5.27E-11, 6.49E-11, 7.95E-11, 9.21E-11, 9.66E-11, 9.82E-11, 9.65E-11, 9.34E-11, 8.73E-11, 7.78E-11, 7.11E-11, 6.41E-11, 5.64E-11, 5.13E-11, 4.47E-11, 3.73E-11, 3.30E-11, 2.89E-11],
    [4.66E-39, 1.76E-29, 7.49E-22, 1.33E-18, 3.51E-16, 2.59E-14, 2.18E-13, 1.81E-12, 9.66E-12, 1.98E-11, 3.39E-11, 5.16E-11, 6.35E-11, 7.79E-11, 9.05E-11, 9.50E-11, 9.66E-11, 9.51E-11, 9.21E-11, 8.62E-11, 7.68E-11, 7.03E-11, 6.34E-11, 5.59E-11, 5.08E-11, 4.43E-11, 3.70E-11, 3.27E-11, 2.87E-11],
    [4.61E-39, 1.74E-29, 7.34E-22, 1.30E-18, 3.42E-16, 2.51E-14, 2.11E-13, 1.75E-12, 9.35E-12, 1.92E-11, 3.28E-11, 5.00E-11, 6.16E-11, 7.57E-11, 8.81E-11, 9.26E-11, 9.44E-11, 9.31E-11, 9.03E-11, 8.46E-11, 7.56E-11, 6.92E-11, 6.25E-11, 5.51E-11, 5.02E-11, 4.38E-11, 3.66E-11, 3.24E-11, 2.84E-11],
    [4.52E-39, 1.68E-29, 7.03E-22, 1.24E-18, 3.23E-16, 2.36E-14, 1.98E-13, 1.63E-12, 8.67E-12, 1.78E-11, 3.04E-11, 4.64E-11, 5.74E-11, 7.08E-11, 8.29E-11, 8.76E-11, 8.97E-11, 8.88E-11, 8.65E-11, 8.13E-11, 7.31E-11, 6.71E-11, 6.07E-11, 5.37E-11, 4.90E-11, 4.28E-11, 3.59E-11, 3.18E-11, 2.79E-11],
    [4.40E-39, 1.62E-29, 6.64E-22, 1.16E-18, 2.99E-16, 2.16E-14, 1.80E-13, 1.47E-12, 7.83E-12, 1.60E-11, 2.74E-11, 4.20E-11, 5.20E-11, 6.45E-11, 7.62E-11, 8.10E-11, 8.35E-11, 8.33E-11, 8.15E-11, 7.72E-11, 6.99E-11, 6.44E-11, 5.86E-11, 5.20E-11, 4.76E-11, 4.17E-11, 3.51E-11, 3.11E-11, 2.74E-11],
    [4.19E-39, 1.51E-29, 6.04E-22, 1.03E-18, 2.63E-16, 1.88E-14, 1.55E-13, 1.26E-12, 6.64E-12, 1.36E-11, 2.33E-11, 3.57E-11, 4.44E-11, 5.55E-11, 6.63E-11, 7.11E-11, 7.40E-11, 7.47E-11, 7.37E-11, 7.06E-11, 6.47E-11, 6.01E-11, 5.51E-11, 4.93E-11, 4.53E-11, 4.00E-11, 3.38E-11, 3.01E-11, 2.66E-11],
    [3.73E-39, 1.28E-29, 4.86E-22, 8.07E-19, 2.00E-16, 1.39E-14, 1.14E-13, 9.14E-13, 4.79E-12, 9.76E-12, 1.68E-11, 2.58E-11, 3.23E-11, 4.07E-11, 4.95E-11, 5.38E-11, 5.69E-11, 5.86E-11, 5.86E-11, 5.73E-11, 5.38E-11, 5.08E-11, 4.73E-11, 4.31E-11, 4.01E-11, 3.59E-11, 3.09E-11, 2.78E-11, 2.47E-11],
    [3.21E-39, 1.05E-29, 3.79E-22, 6.15E-19, 1.50E-16, 1.03E-14, 8.34E-14, 6.65E-13, 3.47E-12, 7.05E-12, 1.21E-11, 1.87E-11, 2.34E-11, 2.97E-11, 3.65E-11, 4.01E-11, 4.29E-11, 4.48E-11, 4.53E-11, 4.50E-11, 4.32E-11, 4.14E-11, 3.92E-11, 3.63E-11, 3.41E-11, 3.11E-11, 2.73E-11, 2.48E-11, 2.24E-11],
    [2.60E-39, 8.05E-30, 2.77E-22, 4.41E-19, 1.06E-16, 7.18E-15, 5.79E-14, 4.59E-13, 2.38E-12, 4.84E-12, 8.29E-12, 1.28E-11, 1.60E-11, 2.04E-11, 2.53E-11, 2.80E-11, 3.02E-11, 3.20E-11, 3.27E-11, 3.30E-11, 3.24E-11, 3.15E-11, 3.02E-11, 2.85E-11, 2.72E-11, 2.52E-11, 2.26E-11, 2.08E-11, 1.91E-11],
    [1.84E-39, 5.29E-30, 1.71E-22, 2.66E-19, 6.28E-17, 4.21E-15, 3.37E-14, 2.65E-13, 1.37E-12, 2.76E-12, 4.72E-12, 7.24E-12, 9.07E-12, 1.16E-11, 1.44E-11, 1.61E-11, 1.75E-11, 1.88E-11, 1.94E-11, 2.00E-11, 2.01E-11, 1.99E-11, 1.94E-11, 1.87E-11, 1.81E-11, 1.72E-11, 1.58E-11, 1.49E-11, 1.39E-11],
    [1.38E-39, 3.75E-30, 1.15E-22, 1.76E-19, 4.11E-17, 2.72E-15, 2.17E-14, 1.69E-13, 8.68E-13, 1.75E-12, 2.98E-12, 4.55E-12, 5.69E-12, 7.24E-12, 9.06E-12, 1.01E-11, 1.11E-11, 1.20E-11, 1.25E-11, 1.30E-11, 1.32E-11, 1.32E-11, 1.31E-11, 1.28E-11, 1.25E-11, 1.20E-11, 1.13E-11, 1.08E-11, 1.02E-11],
    [1.04E-39, 2.67E-30, 7.73E-23, 1.15E-19, 2.65E-17, 1.74E-15, 1.37E-14, 1.06E-13, 5.41E-13, 1.09E-12, 1.84E-12, 2.81E-12, 3.50E-12, 4.45E-12, 5.58E-12, 6.25E-12, 6.88E-12, 7.47E-12, 7.81E-12, 8.16E-12, 8.43E-12, 8.50E-12, 8.49E-12, 8.39E-12, 8.27E-12, 8.04E-12, 7.68E-12, 7.40E-12, 7.09E-12],
    [7.63E-40, 1.76E-30, 4.61E-23, 6.60E-20, 1.48E-17, 9.41E-16, 7.34E-15, 5.63E-14, 2.85E-13, 5.71E-13, 9.66E-13, 1.47E-12, 1.82E-12, 2.31E-12, 2.90E-12, 3.26E-12, 3.60E-12, 3.92E-12, 4.11E-12, 4.33E-12, 4.51E-12, 4.58E-12, 4.61E-12, 4.60E-12, 4.57E-12, 4.50E-12, 4.36E-12, 4.25E-12, 4.12E-12],
    [6.41E-40, 1.35E-30, 3.18E-23, 4.36E-20, 9.46E-18, 5.90E-16, 4.55E-15, 3.45E-14, 1.74E-13, 3.49E-13, 5.90E-13, 8.95E-13, 1.11E-12, 1.41E-12, 1.78E-12, 2.00E-12, 2.21E-12, 2.41E-12, 2.53E-12, 2.67E-12, 2.80E-12, 2.85E-12, 2.88E-12, 2.88E-12, 2.87E-12, 2.84E-12, 2.78E-12, 2.72E-12, 2.65E-12],
    [5.68E-40, 1.08E-30, 2.25E-23, 2.93E-20, 6.12E-18, 3.71E-16, 2.82E-15, 2.12E-14, 1.06E-13, 2.13E-13, 3.60E-13, 5.47E-13, 6.82E-13, 8.66E-13, 1.09E-12, 1.23E-12, 1.36E-12, 1.49E-12, 1.57E-12, 1.66E-12, 1.74E-12, 1.77E-12, 1.80E-12, 1.81E-12, 1.80E-12, 1.79E-12, 1.75E-12, 1.72E-12, 1.69E-12],
    [5.21E-40, 8.54E-31, 1.50E-23, 1.80E-20, 3.53E-18, 2.04E-16, 1.51E-15, 1.11E-14, 5.52E-14, 1.10E-13, 1.87E-13, 2.86E-13, 3.57E-13, 4.55E-13, 5.79E-13, 6.55E-13, 7.28E-13, 8.01E-13, 8.45E-13, 8.95E-13, 9.41E-13, 9.61E-13, 9.74E-13, 9.80E-13, 9.80E-13, 9.73E-13, 9.56E-13, 9.41E-13, 9.22E-13],
    [5.11E-40, 7.55E-31, 1.15E-23, 1.28E-20, 2.37E-18, 1.30E-16, 9.47E-16, 6.84E-15, 3.36E-14, 6.72E-14, 1.14E-13, 1.75E-13, 2.19E-13, 2.81E-13, 3.61E-13, 4.10E-13, 4.57E-13, 5.05E-13, 5.34E-13, 5.67E-13, 5.97E-13, 6.10E-13, 6.19E-13, 6.23E-13, 6.23E-13, 6.20E-13, 6.10E-13, 6.00E-13, 5.88E-13],
    [5.16E-40, 6.90E-31, 9.00E-24, 9.27E-21, 1.62E-18, 8.47E-17, 6.01E-16, 4.25E-15, 2.07E-14, 4.13E-14, 7.02E-14, 1.08E-13, 1.36E-13, 1.76E-13, 2.27E-13, 2.59E-13, 2.90E-13, 3.21E-13, 3.41E-13, 3.63E-13, 3.82E-13, 3.90E-13, 3.96E-13, 3.99E-13, 3.99E-13, 3.97E-13, 3.91E-13, 3.85E-13, 3.78E-13],
    [5.31E-40, 6.34E-31, 6.83E-24, 6.39E-21, 1.03E-18, 5.05E-17, 3.45E-16, 2.35E-15, 1.11E-14, 2.20E-14, 3.74E-14, 5.76E-14, 7.28E-14, 9.42E-14, 1.23E-13, 1.41E-13, 1.59E-13, 1.78E-13, 1.89E-13, 2.02E-13, 2.14E-13, 2.19E-13, 2.22E-13, 2.24E-13, 2.25E-13, 2.23E-13, 2.20E-13, 2.17E-13, 2.12E-13],
    [5.39E-40, 6.03E-31, 5.80E-24, 5.09E-21, 7.74E-19, 3.55E-17, 2.33E-16, 1.52E-15, 6.92E-15, 1.35E-14, 2.26E-14, 3.47E-14, 4.38E-14, 5.68E-14, 7.44E-14, 8.59E-14, 9.76E-14, 1.10E-13, 1.18E-13, 1.27E-13, 1.35E-13, 1.39E-13, 1.42E-13, 1.44E-13, 1.45E-13, 1.45E-13, 1.43E-13, 1.41E-13, 1.38E-13],
    [5.33E-40, 5.75E-31, 5.09E-24, 4.20E-21, 5.92E-19, 2.49E-17, 1.55E-16, 9.50E-16, 4.12E-15, 7.89E-15, 1.31E-14, 1.99E-14, 2.51E-14, 3.25E-14, 4.27E-14, 4.96E-14, 5.66E-14, 6.43E-14, 6.94E-14, 7.56E-14, 8.16E-14, 8.48E-14, 8.75E-14, 8.98E-14, 9.08E-14, 9.16E-14, 9.15E-14, 9.08E-14, 8.96E-14]
])

# conversion from cm^-3 to m^-3
density_axis *= 1e6
recombination_pec *= 1e-6
excitation_pec *= 1e-6

log_density_axis = log(density_axis)
log_temperature_axis = log(temperature_axis)
log_recombination_pec = log(recombination_pec)
log_excitation_pec = log(excitation_pec)

print(log_temperature_axis.shape, log_density_axis.shape, log_recombination_pec.shape)


from mpl_toolkits.mplot3d import Axes3D  # noqa: F401 unused import
import matplotlib.pyplot as plt


fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')

ax.scatter(*meshgrid(log_temperature_axis, log_density_axis), log_recombination_pec, c = log_recombination_pec)

ax.set_xlabel('log-temperature')
ax.set_ylabel('log-density')
ax.set_zlabel('log-PEC')
plt.show()



fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')

ax.scatter(*meshgrid(log_temperature_axis, log_density_axis), log_excitation_pec, c = log_excitation_pec)

ax.set_xlabel('log-temperature')
ax.set_ylabel('log-density')
ax.set_zlabel('log-PEC')
plt.show()




# from scipy.interpolate import RectBivariateSpline
#
# spline = RectBivariateSpline(log_density_axis, log_temperature_axis, log_excitation_pec)
# temperature_cut = linspace(log_temperature_axis.min(), log_temperature_axis.max(), 300)
# density_cut = linspace(log_density_axis.min(), log_density_axis.max(), 300)



savez('d_epsilon_pec_data.npz',
      ln_ne = log_density_axis,
      ln_te = log_temperature_axis,
      exc_ln_pec = log_excitation_pec,
      rec_ln_pec = log_recombination_pec)



from midas.emission import AdasLineModel

model = AdasLineModel.build('D_epsilon')



print( model(1.2, 2e19, 5e18) )
print( model(6.5, 3.5e19, 8e18) )



